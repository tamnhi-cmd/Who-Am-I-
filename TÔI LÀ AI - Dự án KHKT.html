<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>T√îI L√Ä AI? - H√†nh tr√¨nh t√¨m l·∫°i m√¨nh gi·ªØa ƒë√°m ƒë√¥ng</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">

  <style>
    /* =========================
       THEME VARIABLES
       ========================= */
    :root{
      --bg-a: #c7b7ff;   /* t√≠m pastel */
      --bg-b: #aef0f6;   /* xanh bi·ªÉn nh·∫°t */
      --bg-c: #ffd2ea;   /* h·ªìng pastel */
      --card: rgba(255,255,255,0.72);
      --glass: rgba(255,255,255,0.10);
      --accent: #6b21a8; /* t√≠m ƒë·∫≠m */
      --accent-2: #db2777; /* h·ªìng ƒë·∫≠m */
      --muted: #6b7280;
      --text: #061826;
      --shadow: rgba(6,8,20,0.12);
    }

    /* =========================
       RESET & BASE
       ========================= */
    *{box-sizing:border-box; margin:0; padding:0}
    html,body{height:100%}
    body{
      font-family: "Nunito", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
      background: linear-gradient(135deg, var(--bg-a) 0%, var(--bg-b) 50%, var(--bg-c) 100%);
      position:relative;
      overflow:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Aurora moving overlay (soft blobs + particles) */
    .aurora {
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:0;
      background: transparent;
    }

    /* Particle canvas sits above aurora but below UI */
    #particle-canvas {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
    }

    /* App container */
    .app {
      width:100%;
      max-width:980px;
      z-index:2;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* main card (now more open, centered) */
    .card {
      width:100%;
      border-radius:20px;
      padding:36px;
      background: linear-gradient(180deg, rgba(255,255,255,0.78), rgba(255,255,255,0.66));
      box-shadow: 0 18px 60px var(--shadow);
      border: 1px solid rgba(255,255,255,0.45);
      backdrop-filter: blur(8px) saturate(120%);
      min-height:520px;
      overflow:hidden;
      position:relative;
    }

    /* Header - simplified and elegant */
    .header {
      display:flex;
      align-items:flex-start;
      gap:18px;
      margin-bottom:18px;
    }
    .title-block {
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .title-h1 {
      font-family: "Playfair Display", serif;
      font-size:22px;
      font-weight:700;
      color:var(--accent);
      letter-spacing:0.2px;
    }
    .subtitle {
      font-size:14px;
      color:var(--muted);
    }

    /* central stage */
    .stage {
      display:flex;
      gap:28px;
      align-items:flex-start;
      margin-top:6px;
      flex-wrap:wrap;
    }
    .main {
      flex:1 1 62%;
      min-width:280px;
    }
    .side {
      flex:0 0 34%;
      min-width:220px;
    }

    /* opening quote (centered, typewriter) */
    .quote-wrap {
      padding:18px 10px 12px 10px;
      margin-bottom:18px;
    }
    .typewriter {
      display:inline-block;
      font-size:18px;
      font-weight:600;
      color:var(--text);
      font-family: "Playfair Display", serif;
      white-space:nowrap;
      overflow:hidden;
      border-right: .12em solid rgba(6,24,38,0.5);
      animation: typing 3.4s steps(42,end) 0.25s forwards, blink .8s step-end infinite;
      max-width:100%;
    }
    @keyframes typing { from { width: 0; } to { width: 100%; } }
    @keyframes blink { 50% { border-color: transparent; } }

    /* subtle subtitle & call-to-action */
    .cta {
      margin-top:18px;
      display:flex;
      align-items:center;
      gap:14px;
    }
    .btn {
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      color:white; padding:12px 20px; border-radius:18px; border:none; cursor:pointer; font-weight:700;
      box-shadow: 0 18px 50px rgba(107,33,168,0.12);
      transition: transform .2s ease, box-shadow .2s ease;
      font-size:15px;
    }
    .btn:hover{ transform: translateY(-6px) scale(1.02); box-shadow: 0 32px 70px rgba(107,33,168,0.18) }
    .btn.ghost { background: transparent; color:var(--muted); border:1px solid rgba(6,24,38,0.05); box-shadow:none; padding:10px 16px }

    /* right side info */
    .side .card-mini {
      background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.45));
      padding:14px;
      border-radius:12px;
      box-shadow: 0 8px 28px rgba(6,8,20,0.04);
      border:1px solid rgba(255,255,255,0.35);
      margin-bottom:12px;
    }
    .side .tag { color:var(--accent-2); font-weight:700; }

    /* section slides (kept as earlier but restyled) */
    .slide {
      background: transparent;
      border-radius:12px;
      padding:0;
      box-shadow:none;
      min-height:0;
      overflow:visible;
      transition: opacity .45s ease, transform .45s cubic-bezier(.2,.9,.25,1);
    }
    .slide.hidden { display:none; }
    .slide.enter { animation: slideIn .45s cubic-bezier(.2,.9,.25,1) both; }
    @keyframes slideIn { from{ transform: translateY(12px) scale(.995); opacity:0 } to{ transform: translateY(0) scale(1); opacity:1 } }

    /* content inside slides */
    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.75));
      padding:18px; border-radius:12px; box-shadow: 0 12px 40px rgba(6,8,20,0.04);
      border:1px solid rgba(6,8,20,0.03);
    }

    .choices{ display:flex; flex-direction:column; gap:12px; margin-top:8px }
    .choice-btn{
      background: linear-gradient(90deg, rgba(107,33,168,0.06), rgba(219,39,119,0.04));
      border: none; padding:12px 16px; border-radius:12px; color:var(--text);
      font-weight:700; cursor:pointer; text-align:left; transition: transform .12s ease, box-shadow .12s, background .2s;
      box-shadow: 0 8px 26px rgba(6,8,20,0.03);
    }
    .choice-btn:hover{
      transform: translateY(-6px);
      box-shadow: 0 18px 36px rgba(107,33,168,0.08);
      background: linear-gradient(90deg, rgba(107,33,168,0.10), rgba(219,39,119,0.06));
    }
    .choice-btn.selected{
      outline: 3px solid rgba(107,33,168,0.10);
      transform: scale(1.02);
      background: linear-gradient(90deg, rgba(107,33,168,0.16), rgba(219,39,119,0.10));
    }

    .feedback{
      margin-top:12px; padding:12px 14px; border-radius:10px;
      background: linear-gradient(90deg, rgba(165,243,252,0.06), rgba(255,255,255,0.02));
      color: #064e47; font-style:italic; border-left:4px solid rgba(58,167,184,0.12);
      box-shadow: 0 6px 20px rgba(6,8,20,0.02);
    }

    textarea, input[type="text"]{
      width:100%; min-height:64px; resize:vertical; padding:12px; border-radius:12px;
      border:1px solid rgba(6,8,20,0.04); font-size:15px;
      background: rgba(255,255,255,0.88);
      box-shadow: inset 0 6px 18px rgba(6,8,20,0.02);
    }
    .small { font-size:13px; color:var(--muted); margin-top:8px; }

    .progress{
      width:100%; height:10px; background:linear-gradient(90deg, rgba(255,255,255,0.6), rgba(255,255,255,0.3)); border-radius:16px; overflow:hidden; margin-top:14px;
    }
    .progress > i{ display:block; height:100%; background:linear-gradient(90deg,var(--bg-b),var(--bg-c)); width:0%; transition:width .45s ease; }

    .result-card{
      text-align:left; padding:18px; border-radius:12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.92), rgba(255,255,255,0.82));
      box-shadow: 0 12px 40px rgba(6,8,20,0.04);
    }
    .tag{ font-weight:700; color:var(--accent-2) }

    /* responsive */
    @media (max-width:900px){
      .stage{ flex-direction:column; }
      .side{ order:2 }
      .main{ order:1 }
      .card { padding:20px; min-height:640px; }
    }

    /* small animation helper for fade-out (when navigating; JS may use) */
    .fade-out { animation: fadeOut .45s ease forwards; }
    @keyframes fadeOut { from { opacity:1; } to { opacity:0; transform: translateY(-6px) } }
    /* Cho ph√©p cu·ªôn trong khung n·ªôi dung t·ª´ng slide */
.slide .panel {
  max-height: 90vh;          /* Gi·ªõi h·∫°n chi·ªÅu cao t·ªëi ƒëa = 90% chi·ªÅu cao m√†n h√¨nh */
  overflow-y: auto;          /* B·∫≠t cu·ªôn d·ªçc khi n·ªôi dung d√†i h∆°n khung */
  padding-right: 10px;       /* Th√™m t√≠ kho·∫£ng tr·ªëng cho ƒë·∫πp */
  scroll-behavior: smooth;   /* Cu·ªôn m∆∞·ª£t */
}

  </style>
</head>
<body>
  <!-- Aurora decorative layer -->
  <div class="aurora" aria-hidden="true">
    <!-- soft moving colored shapes via SVG for richer aurora layering -->
    <svg style="position:absolute; inset: -20% -20% auto auto; width:160%; height:140%; z-index:0; pointer-events:none;" viewBox="0 0 800 400" preserveAspectRatio="xMidYMid slice">
      <defs>
        <linearGradient id="AG" x1="0" x2="1"><stop offset="0" stop-color="#c7b7ff"/><stop offset="0.5" stop-color="#aef0f6"/><stop offset="1" stop-color="#ffd2ea"/></linearGradient>
        <filter id="gblur"><feGaussianBlur stdDeviation="30" /></filter>
      </defs>
      <g opacity="0.28" filter="url(#gblur)">
        <ellipse cx="160" cy="120" rx="220" ry="90" fill="url(#AG)" />
        <ellipse cx="620" cy="70" rx="240" ry="110" fill="url(#AG)" />
        <ellipse cx="460" cy="320" rx="300" ry="120" fill="url(#AG)" />
      </g>
    </svg>
  </div>

  <!-- Particle canvas (glowing dots) -->
  <canvas id="particle-canvas"></canvas>

  <div class="app">
    <div class="card" role="main" aria-labelledby="main-title">

      <!-- Header -->
      <div class="header">
        <div class="title-block">
          <div id="main-title" class="title-h1">T√îI L√Ä AI? - H√†nh tr√¨nh t√¨m l·∫°i m√¨nh gi·ªØa ƒë√°m ƒë√¥ng</div>
          <div class="subtitle">Khi ƒë√®n t·∫Øt, b·∫°n l√† ai?</div>
        </div>
        <!-- right small hint -->
        <div style="margin-left:auto; color:var(--muted); font-size:13px;">D·ª± √°n: ‚Äúƒê·ªìng ph·ª•c t√≠nh c√°ch‚Äù: √Åp l·ª±c h√≤a nh·∫≠p v√† kh·ªßng ho·∫£ng b·∫£n s·∫Øc c√° nh√¢n ·ªü h·ªçc sinh Tr∆∞·ªùng THPT Nguy·ªÖn Tr√£i, th√†nh ph·ªë ƒê√† N·∫µng.
</div>
      </div>

      <!-- Stage -->
      <div class="stage">

        <!-- Main area (intro slide visible initially) -->
        <div class="main">
          <section id="slide-intro" class="slide">
            <div class="panel">
              <div class="quote-wrap center">
                <span class="typewriter">‚ÄúB·∫°n ƒë√£ s·∫µn s√†ng ƒë·ªÉ ƒë√°nh th·ª©c b·∫£n s·∫Øc c√° nh√¢n c·ªßa ch√≠nh m√¨nh ?‚Äù</span>
              </div>

              <div style="display:flex; gap:18px; align-items:center; justify-content:flex-start; flex-wrap:wrap;">
                <button class="btn" onclick="goTo('slide-1')">B·∫Øt ƒë·∫ßu h√†nh tr√¨nh c·ªßa t√¥i</button>
                <button class="btn ghost" onclick="goTo('slide-1')">Kh√°m ph√° ngay</button>
              </div>

              <div class="progress" aria-hidden="true" style="margin-top:22px;"><i style="width:5%"></i></div>
            </div>
          </section>

          <!-- Slide 1 (Nh·∫≠n di·ªán) -->
          <section id="slide-1" class="slide hidden">
            <div class="panel">
              <h2 style="font-family:Playfair Display; color:var(--accent); margin-bottom:8px;">Ch·∫∑ng 1 - Nh·∫≠n di·ªán b·∫£n th√¢n</h2>
              <p class="small">Ch·ªçn 1 ƒëi·ªÅu khi·∫øn b·∫°n c·∫£m th·∫•y "l√† ch√≠nh m√¨nh" nh·∫•t (c√≥ th·ªÉ ch·ªçn nhi·ªÅu, t·ªëi ƒëa 3).</p>

              <div style="margin-top:12px" class="choices" id="choiceList">
                <button class="choice-btn" data-key="creative" onclick="toggleChoice(this)">Khi m√¨nh s√°ng t·∫°o</button>
                <button class="choice-btn" data-key="help" onclick="toggleChoice(this)">Khi m√¨nh gi√∫p ƒë·ª° ng∆∞·ªùi kh√°c</button>
                <button class="choice-btn" data-key="brave" onclick="toggleChoice(this)">Khi m√¨nh d√°m n√≥i ƒëi·ªÅu m√¨nh nghƒ©</button>
                <button class="choice-btn" data-key="goal" onclick="toggleChoice(this)">Khi m√¨nh ho√†n th√†nh m·ªôt m·ª•c ti√™u</button>
                <button class="choice-btn" data-key="same" onclick="toggleChoice(this)">Khi m√¨nh gi·ªëng v·ªõi m·ªçi ng∆∞·ªùi</button>
              </div>

              <div id="feedbackBox" class="feedback" style="display:none"></div>

              <div style="margin-top:14px; display:flex; gap:12px;">
                <button class="btn" onclick="goTo('slide-1b')">Ti·∫øp t·ª•c</button>
                <button class="btn ghost" onclick="goTo('slide-intro')">Quay l·∫°i</button>
              </div>

              <div class="progress" style="margin-top:18px;"><i style="width:25%"></i></div>
            </div>
          </section>

          <!-- Slide 1B (vi·∫øt c·∫£m x√∫c) -->
          <section id="slide-1b" class="slide hidden">
            <div class="panel">
              <h2 style="font-family:Playfair Display; color:var(--accent); margin-bottom:8px;">Vi·∫øt nhanh 3 d√≤ng c·∫£m x√∫c</h2>
              <p class="small">ƒêi·ªÅn nhanh - kh√¥ng c·∫ßn qu√° d√†i, ƒëi·ªÅu ƒë·∫ßu ti√™n hi·ªán l√™n trong ƒë·∫ßu l√† ƒë∆∞·ª£c.</p>

              <div style="margin-top:12px;">
                <p style="font-weight:700">1. <small class="small">T√¥i t·ª± tin nh·∫•t khi...</small></p>
                <textarea id="ans1" placeholder="V√≠ d·ª•: Khi t√¥i v·∫Ω/ Khi t√¥i tr√¨nh b√†y..."></textarea>

                <p style="margin-top:12px; font-weight:700">2. <small class="small">T√¥i th·∫•y l·∫°c l√µng khi...</small></p>
                <textarea id="ans2" placeholder="V√≠ d·ª•: Khi m·ªçi ng∆∞·ªùi kh√¥ng hi·ªÉu t√¥i..."></textarea>

                <p style="margin-top:12px; font-weight:700">3. <small class="small">N·∫øu ai h·ªèi t√¥i l√† ai, t√¥i s·∫Ω n√≥i r·∫±ng...</small></p>
                <textarea id="ans3" placeholder="Vi·∫øt 1‚Äì2 c√¢u ng·∫Øn g·ªçn"></textarea>

                <div style="margin-top:14px; display:flex; gap:12px;">
                  <button class="btn" onclick="completeStage1()">Ho√†n th√†nh</button>
                  <button class="btn ghost" onclick="goTo('slide-1')">Quay l·∫°i</button>
                </div>
              </div>

              <div class="progress" style="margin-top:18px;"><i style="width:40%"></i></div>
            </div>
          </section>

          <!-- Slide 2 -->
          <section id="slide-2" class="slide hidden">
            <div class="panel">
              <h2 style="font-family:Playfair Display; color:var(--accent); margin-bottom:8px;">Ch·∫∑ng 2 - √Åp l·ª±c h√≤a nh·∫≠p (The Mask)</h2>
              <p class="small">Nh·∫≠n di·ªán khi n√†o b·∫°n ‚Äúm·∫∑c m·∫∑t n·∫°‚Äù ƒë·ªÉ h√≤a nh·∫≠p.</p>

              <div style="margin-top:12px;">
                <p style="font-weight:700">T√¨nh hu·ªëng - ‚ÄúMy favourite song‚Äù</p>
                <p class="small">B·∫°n r·∫•t y√™u th√≠ch m·ªôt b√†i h√°t, tuy nhi√™n th·ªÉ lo·∫°i ƒë√≥ kh√¥ng ph√π h·ª£p v·ªõi m·ªôt s·ªë b·∫°n, v√† theo h·ªç b·∫°n th·∫≠t l·∫≠p d·ªã. B·∫°n s·∫Ω:</p>

                <div class="choices" style="margin-top:8px">
                  <button class="choice-btn" data-key="mask_1" onclick="selectSingle('mask','1',this)">1Ô∏è‚É£ Kh√¥ng nghe n·ªØa. </button>
                  <button class="choice-btn" data-key="mask_2" onclick="selectSingle('mask','2',this)">2Ô∏è‚É£ M·∫∑c d√π ng∆∞·ªùi kh√°c n√≥i g√¨, m√¨nh v·∫´n nghe v√¨ ƒë√≥ l√† gu √¢m nh·∫°c c·ªßa m√¨nh.</button>
                  <button class="choice-btn" data-key="mask_3" onclick="selectSingle('mask','3',this)">3Ô∏è‚É£ C∆∞·ªùi tr·ª´, nh∆∞ng trong l√≤ng h∆°i t·ªïn th∆∞∆°ng.</button>
                </div>

                <div id="maskFeedback" class="feedback" style="display:none"></div>

                <hr style="margin:18px 0; border:none; border-top:1px dashed rgba(6,8,20,0.04)">

                <p style="font-weight:700">Chi·∫øc m·∫∑t n·∫° x√£ h·ªôi</p>
                <div class="choices" style="margin-top:8px">
                  <button class="choice-btn" data-key="m1" onclick="selectSingle('face','m1',this)">M·∫∑t n·∫° ‚Äòvui v·∫ª d√π m·ªát m·ªèi‚Äô</button>
                  <button class="choice-btn" data-key="m2" onclick="selectSingle('face','m2',this)">M·∫∑t n·∫° ‚Äòho√†n h·∫£o ƒë·ªÉ ƒë∆∞·ª£c khen‚Äô</button>
                  <button class="choice-btn" data-key="m3" onclick="selectSingle('face','m3',this)">M·∫∑t n·∫° ‚Äòim l·∫∑ng ƒë·ªÉ kh√¥ng b·ªã ch√∫ √Ω‚Äô</button>
                  <button class="choice-btn" data-key="m4" onclick="selectSingle('face','m4',this)">M√¨nh kh√¥ng ƒëeo m·∫∑t n·∫° n√†o c·∫£</button>
                </div>

                <div id="faceFeedback" class="feedback" style="display:none"></div>

                <div style="margin-top:14px; display:flex; gap:12px;">
                  <button class="btn" onclick="goTo('slide-3')">Ti·∫øp t·ª•c ƒë·∫øn Ch·∫∑ng 3</button>
                  <button class="btn ghost" onclick="goTo('slide-1b')">Quay l·∫°i</button>
                </div>
              </div>

              <div class="progress" style="margin-top:18px;"><i style="width:70%"></i></div>
            </div>
          </section>

          <!-- Slide 3 -->
          <section id="slide-3" class="slide hidden">
            <div class="panel">
              <h2 style="font-family:Playfair Display; color:var(--accent); margin-bottom:8px;">Ch·∫∑ng 3 - Kh·∫≥ng ƒë·ªãnh gi√° tr·ªã (I AM ENOUGH)</h2>
              <p class="small">Th·ª±c h√†nh ng√¥n ng·ªØ b·∫£n s·∫Øc & ch·ªçn cam k·∫øt</p>

              <div style="margin-top:12px;">
                <p style="font-weight:700">Ho√†n th√†nh c√¢u:</p>
                <p class="small">‚ÄúM√¨nh t√¥n tr·ªçng √Ω ki·∫øn c·ªßa c·∫≠u, nh∆∞ng ________.‚Äù</p>
                <input id="fill1" placeholder="v√≠ d·ª•: m√¨nh c·∫ßn gi·ªØ quan ƒëi·ªÉm c·ªßa m√¨nh" style="margin-top:8px;">

                <p class="small" style="margin-top:12px">‚ÄúM√¨nh th·∫•y vui khi ƒë∆∞·ª£c l√† ch√≠nh m√¨nh v√¨ ________.‚Äù</p>
                <input id="fill2" placeholder="v√≠ d·ª•: m√¨nh c·∫£m th·∫•y t·ª± do" style="margin-top:8px;">

                <p class="small" style="margin-top:12px">‚Äúƒêi·ªÅu n√†y ·ªü b·∫£n th√¢n m√¨nh s·∫Ω kh√¥ng thay ƒë·ªïi: ________.‚Äù</p>
                <input id="fill3" placeholder="v√≠ d·ª•: l√≤ng t·ªët" style="margin-top:8px">

                <div style="margin-top:14px">
                  <p style="font-weight:700">Ch·ªçn 1 cam k·∫øt ƒë·ªÉ kh√©p l·∫°i h√†nh tr√¨nh:</p>
                  <div class="choices" style="margin-top:8px">
                    <button class="choice-btn" data-key="c1" onclick="selectCommit('c1',this)">‚úÖ T√¥i s·∫Ω s·ªëng th·∫≠t v·ªõi ch√≠nh m√¨nh.</button>
                    <button class="choice-btn" data-key="c2" onclick="selectCommit('c2',this)">‚úÖ T√¥i s·∫Ω l·∫Øng nghe c·∫£m x√∫c c·ªßa b·∫£n th√¢n.</button>
                    <button class="choice-btn" data-key="c3" onclick="selectCommit('c3',this)">‚úÖ T√¥i s·∫Ω t√¥n tr·ªçng s·ª± kh√°c bi·ªát c·ªßa ng∆∞·ªùi kh√°c v√† c·ªßa ch√≠nh t√¥i.</button>
                  </div>
                </div>

                <div style="margin-top:14px; display:flex; gap:12px;">
                  <button class="btn" onclick="finishGame()">Ho√†n t·∫•t & Nh·∫≠n th√¥ng ƒëi·ªáp</button>
                  <button class="btn ghost" onclick="goTo('slide-2')">Quay l·∫°i</button>
                </div>
              </div>

              <div class="progress" style="margin-top:18px;"><i style="width:90%"></i></div>
            </div>
          </section>

          <!-- Slide end -->
          <section id="slide-end" class="slide hidden">
            <div class="panel">
              <h2 style="font-family:Playfair Display; color:var(--accent); margin-bottom:8px;">H√†nh tr√¨nh ho√†n t·∫•t ‚ú®</h2>
              <p class="small">‚Äúƒê·ªìng ph·ª•c c√≥ th·ªÉ gi·ªëng nhau, nh∆∞ng t√¢m h·ªìn th√¨ kh√¥ng ai gi·ªëng ai.‚Äù</p>

              <div id="resultSummary" class="result-card" style="margin-top:12px"></div>

              <div style="margin-top:14px; display:flex; gap:12px;">
                <button class="btn" onclick="restart()">Ch∆°i l·∫°i</button>
                <button class="btn ghost" onclick="goTo('slide-3')">Quay l·∫°i</button>
              </div>

              <div class="progress" style="margin-top:18px;"><i style="width:100%"></i></div>
            </div>
          </section>
        </div>

        <!-- Right side (context / hint) -->
        <div class="side">
          <div class="card-mini">
            <div class="tag">REMINDER:</div>
            <div style="margin-top:6px; font-weight:700; color:var(--accent)">Remember this </div>
            <p class="small" style="margin-top:8px">No one is you, and that is your superpower. üíñ</p>
          </div>

          <div class="card-mini">
            <div class="tag">M·∫πo</div>
            <p class="small" style="margin-top:8px">Trung th·ª±c v·ªõi b·∫£n th√¢n - kh√¥ng c√≥ ƒë√°p √°n ƒë√∫ng/sai. B·∫°n c√≥ th·ªÉ ch·ª•p m√†n h√¨nh k·∫øt qu·∫£ ƒë·ªÉ l∆∞u l·∫°i.</p>
          </div>
        </div>

      </div> <!-- stage -->

    </div> <!-- card -->
  </div> <!-- app -->

  <!-- =========================
       SCRIPT: UI logic kept (adapted safely)
       ========================= -->
  <script>
    /* -------------------------
       Particle effect (small glowing dots) 
       Simple lightweight canvas particles for aurora mood.
       ------------------------- */
    (function initParticles(){
      const canvas = document.getElementById('particle-canvas');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');
      let w=canvas.width=innerWidth;
      let h=canvas.height=innerHeight;
      window.addEventListener('resize', ()=> { w=canvas.width=innerWidth; h=canvas.height=innerHeight; });

      const colors = ["rgba(255,255,255,0.75)","rgba(255,240,248,0.6)","rgba(165,243,252,0.5)","rgba(139,92,246,0.35)"];
      const particles = [];
      const N = Math.max(24, Math.floor((w*h)/90000)); // density responsive
      for(let i=0;i<N;i++){
        particles.push({
          x: Math.random()*w,
          y: Math.random()*h,
          r: 1 + Math.random()*3,
          vx: (Math.random()-0.5)*0.15,
          vy: (Math.random()-0.5)*0.15,
          alpha: 0.05 + Math.random()*0.5,
          c: colors[Math.floor(Math.random()*colors.length)],
        });
      }
      function draw(){
        ctx.clearRect(0,0,w,h);
        for(const p of particles){
          p.x += p.vx;
          p.y += p.vy;
          p.alpha += (Math.random()-0.5)*0.02;
          if(p.alpha < 0.02) p.alpha = 0.02;
          if(p.alpha > 0.9) p.alpha = 0.9;
          if(p.x < -20) p.x = w + 20;
          if(p.x > w + 20) p.x = -20;
          if(p.y < -20) p.y = h + 20;
          if(p.y > h + 20) p.y = -20;

          ctx.beginPath();
          const grad = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.r*6);
          grad.addColorStop(0, p.c.replace(/[\d\.]+\)$/,'0.9)'));
          grad.addColorStop(0.4, p.c.replace(/[\d\.]+\)$/,'0.45)'));
          grad.addColorStop(1, p.c.replace(/[\d\.]+\)$/,'0)'));
          ctx.fillStyle = grad;
          ctx.fillRect(p.x - p.r*6, p.y - p.r*6, p.r*12, p.r*12);
        }
        requestAnimationFrame(draw);
      }
      draw();
    })();

    /* -------------------------
       State l∆∞u tr·ªØ l·ª±a ch·ªçn (kept from original)
       ------------------------- */
    const state = {
      picks: [],          // t·ª´ slide1 (max 3 keys)
      ans1: "", ans2: "", ans3: "",
      maskChoice: null,   // slide2 (mask situation)
      faceMask: null,     // slide2 (social mask)
      fill1: "", fill2: "", fill3: "",
      commit: null
    };

    // helper: show a slide by id (keeps original logic)
    function goTo(id){
      // hide all slides
      document.querySelectorAll('.slide').forEach(s=>{
        s.classList.add('hidden');
        s.classList.remove('enter','exit','fade-out');
      });
      // show requested
      const el = document.getElementById(id);
      if (!el) return;
      el.classList.remove('hidden');
      // trigger enter animation
      void el.offsetWidth;
      el.classList.add('enter');

      // update progress bar visual (kept original widths)
      const progressBars = document.querySelectorAll('.progress > i');
      let width = 5;
      if (id==='slide-intro') width=5;
      if (id==='slide-1') width=25;
      if (id==='slide-1b') width=40;
      if (id==='slide-2') width=70;
      if (id==='slide-3') width=90;
      if (id==='slide-end') width=100;
      progressBars.forEach(pb => pb.style.width = width + '%');

      // update small UI states
      updatePickedCount();
      updateMaskFeedbackUI();
      updateFaceFeedbackUI();
      // smooth scroll to top of card for mobile
      document.querySelector('.card')?.scrollIntoView({behavior:'smooth', block:'start'});
    }

    /* -------------------------
       AUDIO control (no audio element present; safe no-op)
       ------------------------- */
    const audio = document.getElementById('bg-audio'); // null
    let audioPlaying = false;
    function toggleAudio(){
      if(!audio) return; // intentionally no-op
      if(audioPlaying){ audio.pause(); audioPlaying=false; }
      else { audio.play().catch(()=>{}); audioPlaying=true; }
    }

    /* -------------------------
       Choice toggling (slide1) - ch·ªçn t·ªëi ƒëa 3
       ------------------------- */
    function toggleChoice(btn){
      const key = btn.getAttribute('data-key');
      const idx = state.picks.indexOf(key);
      if (idx>-1){
        state.picks.splice(idx,1);
        btn.classList.remove('selected');
      } else {
        if (state.picks.length >= 3){
          // flash small warning
          btn.animate([{ transform:'translateY(0)' },{ transform:'translateY(-6px)' },{ transform:'translateY(0)' }],{ duration:260 });
          return;
        }
        state.picks.push(key);
        btn.classList.add('selected');
      }
      updatePickedCount();
      showFeedbackForPicks();
    }
    function updatePickedCount(){
      const el = document.getElementById('pickedCount');
      if(el) el.innerText = state.picks.length;
    }

    function showFeedbackForPicks(){
      const fb = document.getElementById('feedbackBox');
      if(!fb) return;
      if(state.picks.length===0){ fb.style.display='none'; fb.innerText=''; return; }

      if (state.picks.includes('same') && state.picks.length===1){
        fb.style.display='block';
        fb.innerText = "C·∫£m gi√°c an to√†n ƒë√¥i khi khi·∫øn ta r·ªùi xa ch√≠nh m√¨nh.";
        return;
      }
      if (state.picks.includes('creative')){
        fb.style.display='block';
        fb.innerText = "Tuy·ªát v·ªùi! S√°ng t·∫°o ch√≠nh l√† b·∫£n s·∫Øc - l√† d·∫•u v√¢n tay t√¢m h·ªìn.";
        return;
      }
      if (state.picks.includes('help')){
        fb.style.display='block';
        fb.innerText = "Gi√∫p ƒë·ª° ng∆∞·ªùi kh√°c c≈©ng l√† m·ªôt c√°ch th·ªÉ hi·ªán gi√° tr·ªã b·∫£n th√¢n.";
        return;
      }
      if (state.picks.includes('brave')){
        fb.style.display='block';
        fb.innerText = "Th·∫≠t ƒë√°ng qu√Ω! D√°m n√≥i ra ƒëi·ªÅu m√¨nh nghƒ© l√† bi·ªÉu hi·ªán c·ªßa t·ª± tin v√† b·∫£n lƒ©nh.";
        return;
      }
      if (state.picks.includes('goal')){
        fb.style.display='block';
        fb.innerText = "Ho√†n th√†nh m·ª•c ti√™u l√† ni·ªÅm t·ª± h√†o - nh∆∞ng ƒë·ª´ng qu√™n t·∫≠n h∆∞·ªüng h√†nh tr√¨nh.";
        return;
      }
      fb.style.display='block';
      fb.innerText = "B·∫°n ƒë√£ ch·ªçn nh·ªØng ƒëi·ªÅu quan tr·ªçng - ti·∫øp t·ª•c vi·∫øt c·∫£m x√∫c ƒë·ªÉ hi·ªÉu s√¢u h∆°n nh√©.";
    }

    /* -------------------------
       Slide1b completion
       ------------------------- */
    function completeStage1() {
  try {
    const a1 = document.getElementById('ans1');
    const a2 = document.getElementById('ans2');
    const a3 = document.getElementById('ans3');

    // üîí M√£ h√≥a n·ªôi dung ƒë·ªÉ tr√°nh l·ªói k√Ω t·ª± khi g√µ ti·∫øng Vi·ªát
    state.ans1 = a1 ? encodeURIComponent(a1.value.trim()) : "";
    state.ans2 = a2 ? encodeURIComponent(a2.value.trim()) : "";
    state.ans3 = a3 ? encodeURIComponent(a3.value.trim()) : "";

    // üß© Ki·ªÉm tra ng∆∞·ªùi d√πng ƒë√£ ch·ªçn g√¨ ch∆∞a
    if (state.picks && state.picks.length === 0) {
      if (!confirm("B·∫°n ch∆∞a ch·ªçn m·ª•c n√†o trong 'B·∫£n ƒë·ªì c√°i t√¥i'. C√≥ mu·ªën ti·∫øp t·ª•c kh√¥ng?")) return;
    }

    // ‚úÖ Chuy·ªÉn sang slide k·∫ø ti·∫øp (ƒë·∫£m b·∫£o kh√¥ng crash)
    goTo('slide-2');
  } catch (err) {
    console.error("L·ªói khi x·ª≠ l√Ω ti·∫øng Vi·ªát ho·∫∑c chuy·ªÉn slide:", err);
    alert("ƒê√£ x·∫£y ra l·ªói khi x·ª≠ l√Ω n·ªôi dung. H√£y th·ª≠ l·∫°i nh√© üí´");
  }
}

    /* -------------------------
       Slide2 interactions (single-select with feedback)
       ------------------------- */
    function selectSingle(group, val, btn){
      if (group==='mask'){
        state.maskChoice = val;
        document.querySelectorAll(".choice-btn[data-key^='mask']").forEach(el=>el.classList.remove('selected'));
        btn.classList.add('selected');
        const fb = document.getElementById('maskFeedback');
        if(fb){ fb.style.display='block'; 
          if(val==='1') fb.innerText = "B·∫°n v·ª´a ƒë√°nh ƒë·ªïi s·ª± tho·∫£i m√°i l·∫•y s·ª± ch·∫•p nh·∫≠n - ƒëi·ªÅu ƒë√≥ c√≥ ƒë√°ng kh√¥ng?";
          if(val==='2') fb.innerText = "M·ªôt l·ª±a ch·ªçn m·∫°nh m·∫Ω! S·ªëng th·∫≠t l√† b∆∞·ªõc ƒë·∫ßu ƒë·ªÉ gi·ªØ b·∫£n s·∫Øc.";
          if(val==='3') fb.innerText = "Kh√¥ng sao c·∫£, ƒë√¥i khi ch√∫ng ta ƒë·ªÅu c·∫ßn ƒë∆∞·ª£c th·∫•u hi·ªÉu - quan tr·ªçng l√† ƒë·ª´ng qu√™n m√¨nh th√≠ch g√¨.";
        }
      }
      if (group==='face'){
        state.faceMask = val;
        document.querySelectorAll(".choice-btn[data-key^='m']").forEach(el=>el.classList.remove('selected'));
        btn.classList.add('selected');
        const fb = document.getElementById('faceFeedback');
        if(fb){ fb.style.display='block'; fb.innerText = "Kh√¥ng ai c√≥ th·ªÉ che gi·∫•u m√£i ph√≠a sau m·ªôt chi·∫øc m·∫∑t n·∫°. ƒê√¥i khi, d≈©ng c·∫£m l√† d√°m ƒë·ªëi di·ªán v·ªõi ch√≠nh m√¨nh."; }
      }
    }

    function updateMaskFeedbackUI(){
      if(state.maskChoice){
        const fb = document.getElementById('maskFeedback');
        if(fb) fb.style.display='block';
      }
    }
    function updateFaceFeedbackUI(){
      if(state.faceMask){
        const fb = document.getElementById('faceFeedback');
        if(fb) fb.style.display='block';
      }
    }

    /* -------------------------
       Slide3: commits & fills
       ------------------------- */
    function selectCommit(key, btn){
      state.commit = key;
      document.querySelectorAll('.choice-btn[data-key^="c"]').forEach(el=>el.classList.remove('selected'));
      btn.classList.add('selected');
    }

    function finishGame(){
      const f1 = document.getElementById('fill1');
      const f2 = document.getElementById('fill2');
      const f3 = document.getElementById('fill3');
      state.fill1 = f1 ? f1.value.trim() : "";
      state.fill2 = f2 ? f2.value.trim() : "";
      state.fill3 = f3 ? f3.value.trim() : "";

      if(!state.commit){
        if(!confirm("B·∫°n ch∆∞a ch·ªçn cam k·∫øt. C√≥ mu·ªën ti·∫øp t·ª•c m√† kh√¥ng ch·ªçn kh√¥ng?")) return;
      }
      buildSummary();
      goTo('slide-end');
    }

    function buildSummary(){
      const el = document.getElementById('resultSummary');
      if(!el) return;
      const pickMap = {
        creative: "Khi m√¨nh s√°ng t·∫°o",
        help: "Khi m√¨nh gi√∫p ƒë·ª° ng∆∞·ªùi kh√°c",
        brave: "Khi m√¨nh d√°m n√≥i ƒëi·ªÅu m√¨nh nghƒ©",
        goal: "Khi m√¨nh ho√†n th√†nh m·ªôt m·ª•c ti√™u",
        same: "Khi m√¨nh gi·ªëng v·ªõi m·ªçi ng∆∞·ªùi"
      };
      const picksText = state.picks.length ? state.picks.map(k=>pickMap[k]||k).join(' ‚Ä¢ ') : "Kh√¥ng ch·ªçn m·ª•c n√†o";
      const maskMap = { '1':'Kh√¥ng nghe n·ªØa.', '2':'M·∫∑c d√π ng∆∞·ªùi kh√°c n√≥i g√¨, m√¨nh v·∫´n nghe v√¨ ƒë√≥ l√† gu √¢m nh·∫°c c·ªßa m√¨nh.', '3':'C∆∞·ªùi tr·ª´, nh∆∞ng trong l√≤ng h∆°i t·ªïn th∆∞∆°ng.' };
      const faceMap = { m1:'Vui v·∫ª d√π m·ªát m·ªèi', m2:'Ho√†n h·∫£o ƒë·ªÉ ƒë∆∞·ª£c khen', m3:'Im l·∫∑ng ƒë·ªÉ kh√¥ng b·ªã ch√∫ √Ω', m4:'Kh√¥ng ƒëeo m·∫∑t n·∫°' };
      const commitMap = { c1:'S·ªëng th·∫≠t v·ªõi ch√≠nh m√¨nh', c2:'L·∫Øng nghe c·∫£m x√∫c c·ªßa b·∫£n th√¢n', c3:'T√¥n tr·ªçng kh√°c bi·ªát' };

      el.innerHTML = `
        <h3 style="margin-top:0; font-family:Playfair Display; color:var(--accent)">K·∫øt qu·∫£ h√†nh tr√¨nh c·ªßa b·∫°n</h3>
        <p><strong class="tag">B·∫£n ƒë·ªì c√°i t√¥i:</strong> ${picksText}</p>
        <p><strong class="tag">B·∫°n vi·∫øt:</strong></p>
        <ul>
          <li><em>T√¥i t·ª± tin nh·∫•t khi:</em> ${state.ans1 || '<span style="color:#999">Kh√¥ng ghi</span>'}</li>
          <li><em>T√¥i th·∫•y l·∫°c l√µng khi:</em> ${state.ans2 || '<span style="color:#999">Kh√¥ng ghi</span>'}</li>
          <li><em>N√≥i t√¥i l√† ai:</em> ${state.ans3 || '<span style="color:#999">Kh√¥ng ghi</span>'}</li>
        </ul>
        <p><strong class="tag">T√¨nh hu·ªëng b√†i h√°t:</strong> ${ state.maskChoice ? maskMap[state.maskChoice] : '<span style="color:#999">Ch∆∞a tr·∫£ l·ªùi</span>' }</p>
        <p><strong class="tag">M·∫∑t n·∫° x√£ h·ªôi:</strong> ${ state.faceMask ? faceMap[state.faceMask] : '<span style="color:#999">Ch∆∞a tr·∫£ l·ªùi</span>' }</p>
        <p><strong class="tag">Ng√¥n ng·ªØ b·∫£n s·∫Øc:</strong></p>
        <ul>
          <li>${ state.fill1 || '<span style="color:#999">Kh√¥ng ghi</span>' }</li>
          <li>${ state.fill2 || '<span style="color:#999">Kh√¥ng ghi</span>' }</li>
          <li>${ state.fill3 || '<span style="color:#999">Kh√¥ng ghi</span>' }</li>
        </ul>
        <p><strong class="tag">Cam k·∫øt b·∫°n ch·ªçn:</strong> ${ state.commit ? commitMap[state.commit] : '<span style="color:#999">Kh√¥ng ch·ªçn</span>' }</p>

        <hr style="margin:12px 0; border:none; border-top:1px dashed rgba(6,8,20,0.04)">
        <p style="font-weight:700; color:var(--accent)">‚ÄúB·∫°n kh√¥ng c·∫ßn ph·∫£i h√≤a tan ƒë·ªÉ ƒë∆∞·ª£c y√™u th√≠ch. B·∫£n s·∫Øc c·ªßa b·∫°n ch√≠nh l√† m√≥n qu√† ƒë·ªôc nh·∫•t m√† th·∫ø gi·ªõi ban t·∫∑ng.‚Äù</p>
      `;
    }

    function restart(){
      state.picks = []; state.ans1=''; state.ans2=''; state.ans3=''; state.maskChoice=null; state.faceMask=null;
      state.fill1=''; state.fill2=''; state.fill3=''; state.commit=null;
      document.querySelectorAll('.choice-btn').forEach(b=>b.classList.remove('selected'));
      const els = document.querySelectorAll('textarea, input');
      els.forEach(e=> e.value = '');
      const fb = document.getElementById('feedbackBox').innerHTML=decodeURIComponent(localStorage.getItem("feedbackBox")); if(fb) fb.style.display='none';
      const mf = document.getElementById('maskFeedback'); if(mf) mf.style.display='none';
      const ff = document.getElementById('faceFeedback'); if(ff) ff.style.display='none';
      goTo('slide-intro');
    }

    // init: open intro
    goTo('slide-intro');

    // Accessibility: allow arrow keys to move between slides
    document.addEventListener('keydown', (e)=>{
      const current = [...document.querySelectorAll('.slide')].find(s=>!s.classList.contains('hidden'));
      if(!current) return;
      if(e.key === 'ArrowRight'){
        if(current.id==='slide-intro') goTo('slide-1');
        else if(current.id==='slide-1') goTo('slide-1b');
        else if(current.id==='slide-1b') goTo('slide-2');
        else if(current.id==='slide-2') goTo('slide-3');
        else if(current.id==='slide-3') goTo('slide-end');
      }
      if(e.key === 'ArrowLeft'){
        if(current.id==='slide-1') goTo('slide-intro');
        else if(current.id==='slide-1b') goTo('slide-1');
        else if(current.id==='slide-2') goTo('slide-1b');
        else if(current.id==='slide-3') goTo('slide-2');
        else if(current.id==='slide-end') goTo('slide-3');
      }
    });
  </script>
  <script>
  // Cho ph√©p g√µ ti·∫øng Vi·ªát c√≥ d·∫•u, k·ªÉ c·∫£ khi script kh√°c can thi·ªáp b√†n ph√≠m
  document.querySelectorAll("input, textarea").forEach(el => {
    el.addEventListener("keydown", e => e.stopPropagation());
    el.addEventListener("keypress", e => e.stopPropagation());
  });
</script>
</body>
</html>